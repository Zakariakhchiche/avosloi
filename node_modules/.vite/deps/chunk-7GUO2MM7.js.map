{
  "version": 3,
  "sources": ["../../langchain/dist/prompts/few_shot.js"],
  "sourcesContent": ["import { BaseStringPromptTemplate, } from \"./base.js\";\r\nimport { checkValidTemplate, renderTemplate, } from \"./template.js\";\r\nimport { PromptTemplate } from \"./prompt.js\";\r\n/**\r\n * Prompt template that contains few-shot examples.\r\n * @augments BasePromptTemplate\r\n * @augments FewShotPromptTemplateInput\r\n */\r\nexport class FewShotPromptTemplate extends BaseStringPromptTemplate {\r\n    constructor(input) {\r\n        super(input);\r\n        Object.defineProperty(this, \"lc_serializable\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"examples\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"exampleSelector\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"examplePrompt\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"suffix\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"\"\r\n        });\r\n        Object.defineProperty(this, \"exampleSeparator\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"\\n\\n\"\r\n        });\r\n        Object.defineProperty(this, \"prefix\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"\"\r\n        });\r\n        Object.defineProperty(this, \"templateFormat\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"f-string\"\r\n        });\r\n        Object.defineProperty(this, \"validateTemplate\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.assign(this, input);\r\n        if (this.examples !== undefined && this.exampleSelector !== undefined) {\r\n            throw new Error(\"Only one of 'examples' and 'example_selector' should be provided\");\r\n        }\r\n        if (this.examples === undefined && this.exampleSelector === undefined) {\r\n            throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\r\n        }\r\n        if (this.validateTemplate) {\r\n            let totalInputVariables = this.inputVariables;\r\n            if (this.partialVariables) {\r\n                totalInputVariables = totalInputVariables.concat(Object.keys(this.partialVariables));\r\n            }\r\n            checkValidTemplate(this.prefix + this.suffix, this.templateFormat, totalInputVariables);\r\n        }\r\n    }\r\n    _getPromptType() {\r\n        return \"few_shot\";\r\n    }\r\n    async getExamples(inputVariables) {\r\n        if (this.examples !== undefined) {\r\n            return this.examples;\r\n        }\r\n        if (this.exampleSelector !== undefined) {\r\n            return this.exampleSelector.selectExamples(inputVariables);\r\n        }\r\n        throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\r\n    }\r\n    async partial(values) {\r\n        const newInputVariables = this.inputVariables.filter((iv) => !(iv in values));\r\n        const newPartialVariables = {\r\n            ...(this.partialVariables ?? {}),\r\n            ...values,\r\n        };\r\n        const promptDict = {\r\n            ...this,\r\n            inputVariables: newInputVariables,\r\n            partialVariables: newPartialVariables,\r\n        };\r\n        return new FewShotPromptTemplate(promptDict);\r\n    }\r\n    /**\r\n     * Formats the prompt with the given values.\r\n     * @param values The values to format the prompt with.\r\n     * @returns A promise that resolves to a string representing the formatted prompt.\r\n     */\r\n    async format(values) {\r\n        const allValues = await this.mergePartialAndUserVariables(values);\r\n        const examples = await this.getExamples(allValues);\r\n        const exampleStrings = await Promise.all(examples.map((example) => this.examplePrompt.format(example)));\r\n        const template = [this.prefix, ...exampleStrings, this.suffix].join(this.exampleSeparator);\r\n        return renderTemplate(template, this.templateFormat, allValues);\r\n    }\r\n    serialize() {\r\n        if (this.exampleSelector || !this.examples) {\r\n            throw new Error(\"Serializing an example selector is not currently supported\");\r\n        }\r\n        if (this.outputParser !== undefined) {\r\n            throw new Error(\"Serializing an output parser is not currently supported\");\r\n        }\r\n        return {\r\n            _type: this._getPromptType(),\r\n            input_variables: this.inputVariables,\r\n            example_prompt: this.examplePrompt.serialize(),\r\n            example_separator: this.exampleSeparator,\r\n            suffix: this.suffix,\r\n            prefix: this.prefix,\r\n            template_format: this.templateFormat,\r\n            examples: this.examples,\r\n        };\r\n    }\r\n    static async deserialize(data) {\r\n        const { example_prompt } = data;\r\n        if (!example_prompt) {\r\n            throw new Error(\"Missing example prompt\");\r\n        }\r\n        const examplePrompt = await PromptTemplate.deserialize(example_prompt);\r\n        let examples;\r\n        if (Array.isArray(data.examples)) {\r\n            examples = data.examples;\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid examples format. Only list or string are supported.\");\r\n        }\r\n        return new FewShotPromptTemplate({\r\n            inputVariables: data.input_variables,\r\n            examplePrompt,\r\n            examples,\r\n            exampleSeparator: data.example_separator,\r\n            prefix: data.prefix,\r\n            suffix: data.suffix,\r\n            templateFormat: data.template_format,\r\n        });\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
