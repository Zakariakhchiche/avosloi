{
  "version": 3,
  "sources": ["../../langchain/dist/chains/combine_docs_chain.js"],
  "sourcesContent": ["import { BaseChain } from \"./base.js\";\r\nimport { LLMChain } from \"./llm_chain.js\";\r\nimport { PromptTemplate } from \"../prompts/prompt.js\";\r\n/**\r\n * Chain that combines documents by stuffing into context.\r\n * @augments BaseChain\r\n * @augments StuffDocumentsChainInput\r\n */\r\nexport class StuffDocumentsChain extends BaseChain {\r\n    static lc_name() {\r\n        return \"StuffDocumentsChain\";\r\n    }\r\n    get inputKeys() {\r\n        return [this.inputKey, ...this.llmChain.inputKeys].filter((key) => key !== this.documentVariableName);\r\n    }\r\n    get outputKeys() {\r\n        return this.llmChain.outputKeys;\r\n    }\r\n    constructor(fields) {\r\n        super(fields);\r\n        Object.defineProperty(this, \"llmChain\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"inputKey\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"input_documents\"\r\n        });\r\n        Object.defineProperty(this, \"documentVariableName\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"context\"\r\n        });\r\n        this.llmChain = fields.llmChain;\r\n        this.documentVariableName =\r\n            fields.documentVariableName ?? this.documentVariableName;\r\n        this.inputKey = fields.inputKey ?? this.inputKey;\r\n    }\r\n    /** @ignore */\r\n    _prepInputs(values) {\r\n        if (!(this.inputKey in values)) {\r\n            throw new Error(`Document key ${this.inputKey} not found.`);\r\n        }\r\n        const { [this.inputKey]: docs, ...rest } = values;\r\n        const texts = docs.map(({ pageContent }) => pageContent);\r\n        const text = texts.join(\"\\n\\n\");\r\n        return {\r\n            ...rest,\r\n            [this.documentVariableName]: text,\r\n        };\r\n    }\r\n    /** @ignore */\r\n    async _call(values, runManager) {\r\n        const result = await this.llmChain.call(this._prepInputs(values), runManager?.getChild(\"combine_documents\"));\r\n        return result;\r\n    }\r\n    _chainType() {\r\n        return \"stuff_documents_chain\";\r\n    }\r\n    static async deserialize(data) {\r\n        if (!data.llm_chain) {\r\n            throw new Error(\"Missing llm_chain\");\r\n        }\r\n        return new StuffDocumentsChain({\r\n            llmChain: await LLMChain.deserialize(data.llm_chain),\r\n        });\r\n    }\r\n    serialize() {\r\n        return {\r\n            _type: this._chainType(),\r\n            llm_chain: this.llmChain.serialize(),\r\n        };\r\n    }\r\n}\r\n/**\r\n * Combine documents by mapping a chain over them, then combining results.\r\n * @augments BaseChain\r\n * @augments StuffDocumentsChainInput\r\n */\r\nexport class MapReduceDocumentsChain extends BaseChain {\r\n    static lc_name() {\r\n        return \"MapReduceDocumentsChain\";\r\n    }\r\n    get inputKeys() {\r\n        return [this.inputKey, ...this.combineDocumentChain.inputKeys];\r\n    }\r\n    get outputKeys() {\r\n        return this.combineDocumentChain.outputKeys;\r\n    }\r\n    constructor(fields) {\r\n        super(fields);\r\n        Object.defineProperty(this, \"llmChain\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"inputKey\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"input_documents\"\r\n        });\r\n        Object.defineProperty(this, \"documentVariableName\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"context\"\r\n        });\r\n        Object.defineProperty(this, \"returnIntermediateSteps\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"maxTokens\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 3000\r\n        });\r\n        Object.defineProperty(this, \"maxIterations\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 10\r\n        });\r\n        Object.defineProperty(this, \"ensureMapStep\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"combineDocumentChain\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        this.llmChain = fields.llmChain;\r\n        this.combineDocumentChain = fields.combineDocumentChain;\r\n        this.documentVariableName =\r\n            fields.documentVariableName ?? this.documentVariableName;\r\n        this.ensureMapStep = fields.ensureMapStep ?? this.ensureMapStep;\r\n        this.inputKey = fields.inputKey ?? this.inputKey;\r\n        this.maxTokens = fields.maxTokens ?? this.maxTokens;\r\n        this.maxIterations = fields.maxIterations ?? this.maxIterations;\r\n        this.returnIntermediateSteps = fields.returnIntermediateSteps ?? false;\r\n    }\r\n    /** @ignore */\r\n    async _call(values, runManager) {\r\n        if (!(this.inputKey in values)) {\r\n            throw new Error(`Document key ${this.inputKey} not found.`);\r\n        }\r\n        const { [this.inputKey]: docs, ...rest } = values;\r\n        let currentDocs = docs;\r\n        let intermediateSteps = [];\r\n        // For each iteration, we'll use the `llmChain` to get a new result\r\n        for (let i = 0; i < this.maxIterations; i += 1) {\r\n            const inputs = currentDocs.map((d) => ({\r\n                [this.documentVariableName]: d.pageContent,\r\n                ...rest,\r\n            }));\r\n            const canSkipMapStep = i !== 0 || !this.ensureMapStep;\r\n            if (canSkipMapStep) {\r\n                // Calculate the total tokens required in the input\r\n                const formatted = await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({\r\n                    [this.combineDocumentChain.inputKey]: currentDocs,\r\n                    ...rest,\r\n                }));\r\n                const length = await this.combineDocumentChain.llmChain.llm.getNumTokens(formatted);\r\n                const withinTokenLimit = length < this.maxTokens;\r\n                // If we can skip the map step, and we're within the token limit, we don't\r\n                // need to run the map step, so just break out of the loop.\r\n                if (withinTokenLimit) {\r\n                    break;\r\n                }\r\n            }\r\n            const results = await this.llmChain.apply(inputs, \r\n            // If we have a runManager, then we need to create a child for each input\r\n            // so that we can track the progress of each input.\r\n            runManager\r\n                ? Array.from({ length: inputs.length }, (_, i) => runManager.getChild(`map_${i + 1}`))\r\n                : undefined);\r\n            const { outputKey } = this.llmChain;\r\n            // If the flag is set, then concat that to the intermediate steps\r\n            if (this.returnIntermediateSteps) {\r\n                intermediateSteps = intermediateSteps.concat(results.map((r) => r[outputKey]));\r\n            }\r\n            currentDocs = results.map((r) => ({\r\n                pageContent: r[outputKey],\r\n                metadata: {},\r\n            }));\r\n        }\r\n        // Now, with the final result of all the inputs from the `llmChain`, we can\r\n        // run the `combineDocumentChain` over them.\r\n        const newInputs = {\r\n            [this.combineDocumentChain.inputKey]: currentDocs,\r\n            ...rest,\r\n        };\r\n        const result = await this.combineDocumentChain.call(newInputs, runManager?.getChild(\"combine_documents\"));\r\n        // Return the intermediate steps results if the flag is set\r\n        if (this.returnIntermediateSteps) {\r\n            return { ...result, intermediateSteps };\r\n        }\r\n        return result;\r\n    }\r\n    _chainType() {\r\n        return \"map_reduce_documents_chain\";\r\n    }\r\n    static async deserialize(data) {\r\n        if (!data.llm_chain) {\r\n            throw new Error(\"Missing llm_chain\");\r\n        }\r\n        if (!data.combine_document_chain) {\r\n            throw new Error(\"Missing combine_document_chain\");\r\n        }\r\n        return new MapReduceDocumentsChain({\r\n            llmChain: await LLMChain.deserialize(data.llm_chain),\r\n            combineDocumentChain: await StuffDocumentsChain.deserialize(data.combine_document_chain),\r\n        });\r\n    }\r\n    serialize() {\r\n        return {\r\n            _type: this._chainType(),\r\n            llm_chain: this.llmChain.serialize(),\r\n            combine_document_chain: this.combineDocumentChain.serialize(),\r\n        };\r\n    }\r\n}\r\n/**\r\n * Combine documents by doing a first pass and then refining on more documents.\r\n * @augments BaseChain\r\n * @augments RefineDocumentsChainInput\r\n */\r\nexport class RefineDocumentsChain extends BaseChain {\r\n    static lc_name() {\r\n        return \"RefineDocumentsChain\";\r\n    }\r\n    get defaultDocumentPrompt() {\r\n        return new PromptTemplate({\r\n            inputVariables: [\"page_content\"],\r\n            template: \"{page_content}\",\r\n        });\r\n    }\r\n    get inputKeys() {\r\n        return [\r\n            ...new Set([\r\n                this.inputKey,\r\n                ...this.llmChain.inputKeys,\r\n                ...this.refineLLMChain.inputKeys,\r\n            ]),\r\n        ].filter((key) => key !== this.documentVariableName && key !== this.initialResponseName);\r\n    }\r\n    get outputKeys() {\r\n        return [this.outputKey];\r\n    }\r\n    constructor(fields) {\r\n        super(fields);\r\n        Object.defineProperty(this, \"llmChain\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"inputKey\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"input_documents\"\r\n        });\r\n        Object.defineProperty(this, \"outputKey\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"output_text\"\r\n        });\r\n        Object.defineProperty(this, \"documentVariableName\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"context\"\r\n        });\r\n        Object.defineProperty(this, \"initialResponseName\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"existing_answer\"\r\n        });\r\n        Object.defineProperty(this, \"refineLLMChain\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"documentPrompt\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: this.defaultDocumentPrompt\r\n        });\r\n        this.llmChain = fields.llmChain;\r\n        this.refineLLMChain = fields.refineLLMChain;\r\n        this.documentVariableName =\r\n            fields.documentVariableName ?? this.documentVariableName;\r\n        this.inputKey = fields.inputKey ?? this.inputKey;\r\n        this.outputKey = fields.outputKey ?? this.outputKey;\r\n        this.documentPrompt = fields.documentPrompt ?? this.documentPrompt;\r\n        this.initialResponseName =\r\n            fields.initialResponseName ?? this.initialResponseName;\r\n    }\r\n    /** @ignore */\r\n    async _constructInitialInputs(doc, rest) {\r\n        const baseInfo = {\r\n            page_content: doc.pageContent,\r\n            ...doc.metadata,\r\n        };\r\n        const documentInfo = {};\r\n        this.documentPrompt.inputVariables.forEach((value) => {\r\n            documentInfo[value] = baseInfo[value];\r\n        });\r\n        const baseInputs = {\r\n            [this.documentVariableName]: await this.documentPrompt.format({\r\n                ...documentInfo,\r\n            }),\r\n        };\r\n        const inputs = { ...baseInputs, ...rest };\r\n        return inputs;\r\n    }\r\n    /** @ignore */\r\n    async _constructRefineInputs(doc, res) {\r\n        const baseInfo = {\r\n            page_content: doc.pageContent,\r\n            ...doc.metadata,\r\n        };\r\n        const documentInfo = {};\r\n        this.documentPrompt.inputVariables.forEach((value) => {\r\n            documentInfo[value] = baseInfo[value];\r\n        });\r\n        const baseInputs = {\r\n            [this.documentVariableName]: await this.documentPrompt.format({\r\n                ...documentInfo,\r\n            }),\r\n        };\r\n        const inputs = { [this.initialResponseName]: res, ...baseInputs };\r\n        return inputs;\r\n    }\r\n    /** @ignore */\r\n    async _call(values, runManager) {\r\n        if (!(this.inputKey in values)) {\r\n            throw new Error(`Document key ${this.inputKey} not found.`);\r\n        }\r\n        const { [this.inputKey]: docs, ...rest } = values;\r\n        const currentDocs = docs;\r\n        const initialInputs = await this._constructInitialInputs(currentDocs[0], rest);\r\n        let res = await this.llmChain.predict({ ...initialInputs }, runManager?.getChild(\"answer\"));\r\n        const refineSteps = [res];\r\n        for (let i = 1; i < currentDocs.length; i += 1) {\r\n            const refineInputs = await this._constructRefineInputs(currentDocs[i], res);\r\n            const inputs = { ...refineInputs, ...rest };\r\n            res = await this.refineLLMChain.predict({ ...inputs }, runManager?.getChild(\"refine\"));\r\n            refineSteps.push(res);\r\n        }\r\n        return { [this.outputKey]: res };\r\n    }\r\n    _chainType() {\r\n        return \"refine_documents_chain\";\r\n    }\r\n    static async deserialize(data) {\r\n        const SerializedLLMChain = data.llm_chain;\r\n        if (!SerializedLLMChain) {\r\n            throw new Error(\"Missing llm_chain\");\r\n        }\r\n        const SerializedRefineDocumentChain = data.refine_llm_chain;\r\n        if (!SerializedRefineDocumentChain) {\r\n            throw new Error(\"Missing refine_llm_chain\");\r\n        }\r\n        return new RefineDocumentsChain({\r\n            llmChain: await LLMChain.deserialize(SerializedLLMChain),\r\n            refineLLMChain: await LLMChain.deserialize(SerializedRefineDocumentChain),\r\n        });\r\n    }\r\n    serialize() {\r\n        return {\r\n            _type: this._chainType(),\r\n            llm_chain: this.llmChain.serialize(),\r\n            refine_llm_chain: this.refineLLMChain.serialize(),\r\n        };\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": ["i"]
}
